{"mappings":"uDAGC,IAKGA,EALAC,EAAc,IAAIC,ECHtBC,EAAeC,GDGSC,YAOxB,MAAMC,EAAoBJ,EAAAC,GAAEI,KAAK,CAC/BC,QAAS,gCACTC,SAAU,CAAC,GAAI,eAqCRC,EAAqBC,EAASC,GACrCD,EAAQE,OAAOC,QAAQF,gCAlCvBZ,EAAOE,EAAAC,GAAEY,IAAI,OAAOC,QAAQ,CAAC,iBAAiB,iBAAmB,KACjEd,EAAAC,GAAEc,UAAU,qDAAsD,CAChEC,YAAa,4FACZC,MAAMnB,uCA2BTA,EAAKoB,YAAYnB,GAtBjBA,EAAc,IAAIC,EAAAC,GAAEkB,YAEpBpB,EAAYqB,cAEZC,QAAQC,IAAI,cACZD,QAAQC,IAAIC,YACZC,SAASC,SAASC,IAChB,IAAIhB,EAEFA,EADEa,WAAWI,IAAID,EAAOE,QAChBxB,EACKyB,aACf,MAAMC,EAAW9B,EAAAC,GAAE8B,OAAO,CAACL,EAAOM,QAASN,EAAOO,UAAW,CAAEC,SAAQ,WAAaR,EAAOE,SAAUvB,KAAMK,IAC3GoB,EAASK,UAAS,GAAIT,EAAOU,UAC7BN,EAASO,GAAG,SAAUC,QAgBLC,EAAgBC,EAAhBD,EAfHD,EAemBE,EAfbd,EAkBlBH,WAAWkB,KAlDG,IAkDsBlB,WAAWI,IAAIa,EAAQZ,SAC7DpB,EAAqB+B,EAAgBnC,GAErCsC,cAAcF,EAAQZ,QACtBL,WAAWoB,IAAIH,EAAQZ,QACvBgB,kBAAkBrB,aAEdA,WAAWI,IAAIa,EAAQZ,SAEvBL,WAASsB,OAAOL,EAAQZ,QAC1BgB,kBAAkBrB,YAClBuB,EAAC,OAAQN,EAAQZ,UAAUmB,SAC3BvC,EAAqB+B,EAAgBV,eAErCmB,aAAaC,eA9BflD,EAAYmD,SAASpB,MAEvBhC,EAAKoD,SAASnD,iCAiCMoD,EAASX,GAC7BM,EAAE,iBAAiBM,OAAM,eACRZ,EAAQZ,gEAAgEY,EAAQZ,WAAWY,EAAQJ,qBAGnHU,EAAA,OAAQN,EAAQZ,UAAUwB,OAAM,gBACfZ,EAAQZ,0CAOYY,EAAAZ,WAAAuB,EAAAE,gDACNb,EAAAZ,WAAAuB,EAAAG,uDACMd,EAAAZ,WAAAuB,EAAAI,kEACOf,EAAAZ,WAAAuB,EAAAK,4CAQ9CC","sources":["scripts/map.js","L.js"],"sourcesContent":["import L from \"leaflet\";\r\n\r\n// Así se pueden guardar los marcadores para cambiar el color\r\nlet aMarcadores = new L.layerGroup();\r\n\r\n// Máximo de Marcadores guardados\r\nlet iMaxGuardados = 5;\r\n\r\nlet mapa;\r\n\r\nconst iconoSeleccionado = L.icon({\r\n  iconUrl: \"../images/marker-selected.png\",\r\n  iconSize: [41, 41],\r\n});\r\n\r\nfunction CargarMapa() {\r\n  mapa = L.map(\"map\").setView([42.983333333333, -2.6166666666667], 8.4);\r\n  L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\", {\r\n    attribution: '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors',\r\n  }).addTo(mapa);\r\n}\r\n\r\nfunction CargarMarcadores() {\r\n  EliminarMarcadores();\r\n  aMarcadores = new L.LayerGroup();\r\n  // console.log();\r\n  aMarcadores.clearLayers();\r\n  // Cargar los marcadores de cada baliza\r\n  console.log(\"aGuardados\");\r\n  console.log(aGuardados);\r\n  aBalizas.forEach((baliza) => {\r\n    let icono;\r\n    if (aGuardados.has(baliza.codigo)) {\r\n      icono = iconoSeleccionado;\r\n    } else icono = iconoDefecto;\r\n    const marcador = L.marker([baliza.latitud, baliza.longitud], { customId: `marcador${baliza.codigo}`, icon: icono });\r\n    marcador.bindPopup(`${baliza.nombre}`);\r\n    marcador.on(\"click\", (marc) => {\r\n      AnadirAMapa(marc, baliza);\r\n    });\r\n    aMarcadores.addLayer(marcador);\r\n  });\r\n  mapa.addLayer(aMarcadores);\r\n}\r\n\r\nfunction EliminarMarcadores() {\r\n  mapa.removeLayer(aMarcadores);\r\n}\r\n\r\nfunction CambiarIconoMarcador(element, icono) {\r\n  element.target.setIcon(icono);\r\n}\r\n\r\nfunction AnadirAMapa(clickedElement, oBaliza) {\r\n  // Comprueba límite de guardados y que no esté ya seleccionado\r\n\r\n  if (aGuardados.size < iMaxGuardados && !aGuardados.has(oBaliza.codigo)) {\r\n    CambiarIconoMarcador(clickedElement, iconoSeleccionado);\r\n\r\n    ObtenerTiempo(oBaliza.codigo);\r\n    aGuardados.add(oBaliza.codigo);\r\n    GuardarMarcadores(aGuardados);\r\n  } else {\r\n    if (aGuardados.has(oBaliza.codigo)) {\r\n      // Si el código ya está, elimina la baliza y lo guarda en el local storage\r\n      aGuardados.delete(oBaliza.codigo);\r\n      GuardarMarcadores(aGuardados);\r\n      $(`#div${oBaliza.codigo}`).remove();\r\n      CambiarIconoMarcador(clickedElement, iconoDefecto);\r\n    } else {\r\n      MostrarError(limitError);\r\n    }\r\n  }\r\n}\r\n\r\nfunction AnadirTiempo(oTiempo, oBaliza) {\r\n  $(\"#divContainer\").append(\r\n    `<div id=\"div${oBaliza.codigo}\" class=\"infoTiempo mw-50 droppableItem\"><h4 id=\"nombre${oBaliza.codigo}\">${oBaliza.nombre}</h4></div>`\r\n  );\r\n  // Añade los datos de tiempo, aunque ocultos todos menos la temperatura y humedad\r\n  $(`#div${oBaliza.codigo}`).append(\r\n    `<div id=\"info${oBaliza.codigo}\" >\r\n        <div id=\"temperatura${oBaliza.codigo}\">${oTiempo.temperatura} º</div>\r\n        <div id=\"humedad${oBaliza.codigo}\">${oTiempo.humedad} %</div>\r\n        <div id=\"presionAtmosferica${oBaliza.codigo}\">${oTiempo.presionAtmosferica} l/m2</div>\r\n        <div id=\"velocidadViento${oBaliza.codigo}\">${oTiempo.velocidadViento} km/h</div>\r\n      </div>`\r\n  );\r\n  // for (prop in aGuardados[usuario]) {\r\n  //   console.log(\"PROP\" + prop);\r\n  //   if (!aGuardados[usuario][prop]) {\r\n  //     $(`#${prop}${oBaliza.codigo}`).hide();\r\n  //   }\r\n  // }\r\n  CrearDroppables();\r\n}\r\n\r\nfunction bBalizaExiste(codigoBaliza) {\r\n  return aGuardados[usuario].filter((e) => e.baliza === codigoBaliza).length > 0;\r\n}\r\n\r\nwindow.CargarMapa = CargarMapa;\r\nwindow.CargarMarcadores = CargarMarcadores;\r\nwindow.AnadirTiempo = AnadirTiempo;\r\nwindow.aMarcadores = aMarcadores;\r\n","module.exports=L;"],"names":["$88ec7b2cc8c60a7c$var$mapa","$88ec7b2cc8c60a7c$var$aMarcadores","$parcel$interopDefault","$66ba7a37141049c3$exports","L","layerGroup","$88ec7b2cc8c60a7c$var$iconoSeleccionado","icon","iconUrl","iconSize","$88ec7b2cc8c60a7c$var$CambiarIconoMarcador","element","icono","target","setIcon","map","setView","tileLayer","attribution","addTo","removeLayer","LayerGroup","clearLayers","console","log","aGuardados","aBalizas","forEach","baliza","has","codigo","iconoDefecto","marcador","marker","latitud","longitud","customId","bindPopup","nombre","on","marc","clickedElement","oBaliza","size","ObtenerTiempo","add","GuardarMarcadores","delete","$","remove","MostrarError","limitError","addLayer","oTiempo","append","temperatura","humedad","presionAtmosferica","velocidadViento","CrearDroppables"],"version":3,"file":"index.d30df50f.js.map"}