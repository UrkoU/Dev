{"mappings":"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","sources":["scripts/main.js"],"sourcesContent":["let aBalizas = [];\r\nlet oTiempo = {};\r\n\r\nlet sColorPrincipal = \"\";\r\nlet sColorSecundario = \"\";\r\n\r\nlet bLogueado = \"\";\r\n\r\nlet tTimeout;\r\n\r\nlet iconoDefecto;\r\n\r\n// Máximo de Marcadores guardados\r\nlet iMaxGuardados = 5;\r\n\r\nfunction PreLogin() {\r\n  CargarLocalStorage();\r\n  CargarColorInicial();\r\n  CargarBotonesColor();\r\n  CrearSlider();\r\n}\r\n\r\nfunction PostLogin() {\r\n  var promesa2 = GetOpcionesUsuario(usuario.id);\r\n  promesa2.then((res) => {\r\n    aGuardados = JSON.parse(res);\r\n    OcultarLogin();\r\n    CargarMapa();\r\n    ObtenerBalizas();\r\n    setInterval(ActualizarDatos, 10000);\r\n  });\r\n}\r\n\r\n$(\"document\").ready(function () {\r\n  PreLogin();\r\n  if (bLogueado == true || bLogueado == \"true\") {\r\n    PostLogin();\r\n  } else {\r\n    MostrarLogin();\r\n  }\r\n});\r\n\r\nfunction ObtenerBalizas() {\r\n  var promise = GetBalizas();\r\n  promise.then(function (data) {\r\n    aBalizas = JSON.parse(data);\r\n    CargarMarcadores();\r\n    CargarCartas(aGuardados);\r\n  });\r\n}\r\n\r\nfunction ObtenerTiempo(id) {\r\n  var promise = GetTiempo(id);\r\n  promise.then(function (data) {\r\n    oTiempo = JSON.parse(data);\r\n    AnadirCarta(oTiempo);\r\n  });\r\n}\r\n\r\n$(\"#mapTop\").click(() => {\r\n  $(\"#map\").toggle();\r\n});\r\n\r\nfunction MostrarLogin() {\r\n  $(\"#divBlur\").css(\"display\", \"flex\");\r\n  $(\"#divLoginContainer\").css(\"display\", \"flex\");\r\n  $(\"#divLogin\").css(\"display\", \"flex\");\r\n}\r\n\r\nfunction OcultarLogin() {\r\n  $(\"#divBlur\").css(\"display\", \"none\");\r\n  $(\"#divLoginContainer\").css(\"display\", \"none\");\r\n  $(\"#divLogin\").css(\"display\", \"none\");\r\n}\r\n\r\nfunction MostrarCartaGrande(oTiempo, oOpciones) {\r\n  console.log(oTiempo);\r\n  console.log(oOpciones);\r\n  console.log(\"Not implemented\");\r\n}\r\n\r\nfunction MostrarError(error = limitError) {\r\n  clearTimeout(tTimeout);\r\n  $(\"#divError\").text(error);\r\n  // Mostrar error, esperar 2 segundos, ocultar\r\n  $(\"#divError\").removeClass(\"hidden\");\r\n  tTimeout = setTimeout(() => {\r\n    $(\"#divError\").addClass(\"hidden\");\r\n  }, 2000);\r\n}\r\n\r\nfunction CargarCartas(balizas) {\r\n  // if (oGuardados[test].length >= 0)\r\n  balizas.forEach((element) => {\r\n    ObtenerTiempo(element.codigoBaliza);\r\n  });\r\n}\r\n\r\nfunction CargarColorInicial() {\r\n  // Carga el color inicial según el local storage\r\n  let sValor, sValorSecundario;\r\n  aColores.forEach((element) => {\r\n    if (element.nombre == sColorPrincipal) {\r\n      sValor = element.valor;\r\n    }\r\n    if (element.nombre == sColorSecundario) sValorSecundario = element.valor;\r\n  });\r\n\r\n  CambiarColorPrimario(sColorPrincipal, sValor, true);\r\n  CambiarColorSecundario(sColorSecundario, sValorSecundario);\r\n}\r\n\r\nfunction CambiarColorPrimario(sColor, sValor, bInicio = false) {\r\n  // Cambia el color predominante de la web, cambiando la variable --main-color del css\r\n  localStorage.setItem(\"sColorPrimario\", sColor);\r\n  document.documentElement.style.setProperty(\"--main-color\", sValor);\r\n  iconoDefecto = L.icon({\r\n    iconUrl: `../images/marker-${sColor}.png`,\r\n    iconSize: [41, 41],\r\n  });\r\n  if (!bInicio) CargarMarcadores();\r\n  // document.getElementsByTagName(\"body\")[0].style.backgroundImage = `url('imagenes/background-${sColor}.png')`;\r\n}\r\n\r\nfunction CambiarColorSecundario(sColor, sValor) {\r\n  localStorage.setItem(\"sColorSecundario\", sColor);\r\n  document.documentElement.style.setProperty(\"--secondary-color\", sValor);\r\n}\r\n\r\nfunction CargarBotonesColor() {\r\n  // Carga los botones de los colores != mainColor\r\n  let divColoresPrincipales = document.getElementById(\"divColoresPrincipales\");\r\n  let divColoresSecundarios = document.getElementById(\"divColoresSecundarios\");\r\n\r\n  sColorPrincipal = localStorage.getItem(\"sColorPrimario\");\r\n  sColorSecundario = localStorage.getItem(\"sColorSecundario\");\r\n  aColores.forEach((oColor) => {\r\n    // Si no es el color principal, añade el botón\r\n    divColoresPrincipales.innerHTML += `<button class=\"color-button color-button-small\" style=\"background-color: ${oColor.valor}\" onclick=\"CambiarColorPrimario('${oColor.nombre}', '${oColor.valor}')\"></button>`;\r\n    divColoresSecundarios.innerHTML += `<button class=\"color-button color-button-small\" style=\"background-color: ${oColor.valor}\" onclick=\"CambiarColorSecundario('${oColor.nombre}', '${oColor.valor}')\"></button>`;\r\n  });\r\n}\r\n\r\n// Gif de ajustes en hover\r\n$(\".settings\").hover(function () {\r\n  $(this).css(\"background\", \"url(../images/settings.gif)\");\r\n  $(this).css(\"background-repeat\", \"no-repeat\");\r\n  $(this).css(\"background-position\", \"center\");\r\n  $(this).css(\"background-size\", \"3.5em\");\r\n});\r\n\r\n$(\".settings\").mouseleave(function () {\r\n  $(this).css(\"background\", \"url(../images/settings-stopped.gif)\");\r\n  $(this).css(\"background-repeat\", \"no-repeat\");\r\n  $(this).css(\"background-position\", \"center\");\r\n  $(this).css(\"background-size\", \"3.5em\");\r\n});\r\n\r\n// Eventos botón flotante\r\n$(\"#show\").on(\"mouseover\", function () {\r\n  $(\"#colores\").removeClass(\"hidden\");\r\n});\r\n$(\"#show\").on(\"mouseout\", function () {\r\n  $(\"#colores\").addClass(\"hidden\");\r\n});\r\n"],"names":["tTimeout","iconoDefecto","aBalizas","oTiempo1","sColorPrincipal","sColorSecundario","bLogueado","iMaxGuardados","PreLogin","CargarLocalStorage","CargarColorInicial","CargarBotonesColor","CrearSlider","PostLogin","GetOpcionesUsuario","usuario","id","then","res","aGuardados","JSON","parse","OcultarLogin","CargarMapa","ObtenerBalizas","setInterval","ActualizarDatos","GetBalizas","data","CargarMarcadores","CargarCartas","ObtenerTiempo","GetTiempo","AnadirCarta","MostrarLogin","$","css","MostrarCartaGrande","oTiempo","oOpciones","console","log","MostrarError","error","limitError","clearTimeout","text","removeClass","setTimeout","addClass","balizas","forEach","element","codigoBaliza","sValor","sValorSecundario","aColores","nombre","valor","CambiarColorPrimario","CambiarColorSecundario","sColor","bInicio","localStorage","setItem","document","documentElement","style","setProperty","L","icon","iconUrl","iconSize","divColoresPrincipales","getElementById","divColoresSecundarios","getItem","oColor","innerHTML","ready","click","toggle","hover","this","mouseleave","on"],"version":3,"file":"index.e44e073c.js.map"}